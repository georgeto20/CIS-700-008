For Part 2, I modified Action Castle by using construct_sentence_vector and find_most_similar_command to allow the parser to understand a greater variety of commands other than simply the hardcoded commands that we implemented in the original game. This allows the player to be more flexible with the input commands. When the player inputs a command, the parser constructs a sentence vector from the player's input and from the known commands associated with an item, and then uses the Magnitude vectors.similarity method to find the most similar command that is possible to execute at the location of the player. The parser repeats this process for every item within the current scope of the game, since a location can have more than one item associated with it (in addition to the inventory). In this case, the parser finds the most similar command for each item and then takes the maximum similarity for all the commands it has found and uses this to determine the most likely item to which its corresponding command should be applied. For example, let's say that the player has picked up the rose in the garden path (but has not yet picked up the fishing pole in the cottage) and then goes south to the fishing pond, at which point the player enters the command "eat fish". The parser looks at the items in the current location (namely, rose and pond) and determines that the pond is the more likely item to which the input command should be applied, as well as that "eat fish" should translate to "catch fish". The parser prints the most similar known command that it has determined and the result of this command ("It seems you're trying to: catch fish. You reach into the pond and try to catch a fish with your hands, but they are too fast."). Similarly, if the player does not yet have the pole and enters "eat fish with pole", the parser prints "It seems you're trying to: catch fish with pole. You don't have the pole"). Note that if a player enters a command that is already known to the parser (e.g. "catch fish"), then the parser doesn't print "It seems you're trying to: catch fish," since it is already familiar with that command.

Another useful feature that I implemented in Part 2 (which also applies to Part 3) is a threshold similarity for finding the most similar command to the player's input. If the parser fails to find a known command which has at least threshold similarity to the input, then the parser simply prints "I'm not sure what you want to do." For example, if the player is at the garden path and has the option to "pick rose" but instead inputs "buy ostrich", then the similarity score between "pick rose" and "buy ostrich" does not satisfy the threshold similarity, and so it prints "I'm not sure what you want to do." Note that this procedure also applies for a location with more than one item: if no item has a corresponding command that meets the threshold, then the parser prints that it's unsure of the player's intentions. I made the threshold a property of the Item class and set its default value to 0.5, as I found this was a good enough value to separate reasonable commands from meaningless ones, but this can be adjusted as necessary.

Finally, in Part 3, I implemented dependency parsing using AllenNLP in an attempt to allow the player to enter multiple commands in one sentence. For example, at the beginning of the game, when the player can "ask ford why he's here" or "ask ford what you need to do", the player can input "ask ford why he's here and what you need to do" and the parser will generate both commands at once. Likewise, at the Ship Bridge, the player can "give poetry book to vogon and attack him", which ends the game with the Vogon attacking the player in retaliation. However, the dependency parsing is quite limited, as it is not always successful at recognizing the verb-object pairs that the player is trying to input. For example, if the player inputs "ask ford what you need to do and why he's here," the parser first executes the "why he's here" command and then the "what you need to do" command. Also, if the player inputs "give book to vogon and attack him" (without the word "poetry" before "book" as before), the parser does not understand that the player wants to attack the vogon because it now only recognizes the "give book" command, allowing the game to continue as if the player did not attempt to attack the vogon. Lastly, the parser can only understand verb-object pairs, and therefore fails given commands like "talk to bartender and cry for help" at the pub, since neither of these commands fall into verb-object categories. These issues may have to do with both the AllenNLP dependency parser and the Magnitude vectors.similarity method, which may incorrectly find certain commands to be less similar than they actually are. For future improvements of the game, I would experiment with other dependency parsers and similarity methods, and perhaps implement coreference resolution to improve the parser's understanding of the player's input, particularly with a sentence of commands rather than simply one command.